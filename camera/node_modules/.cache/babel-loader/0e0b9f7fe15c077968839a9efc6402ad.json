{"remainingRequest":"C:\\ex11\\node_modules\\thread-loader\\dist\\cjs.js!C:\\ex11\\node_modules\\babel-loader\\lib\\index.js!C:\\ex11\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\ex11\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\ex11\\src\\components\\camera_page.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\ex11\\src\\components\\camera_page.vue","mtime":1638173624294},{"path":"C:\\ex11\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1654499746565},{"path":"C:\\ex11\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1654499746462},{"path":"C:\\ex11\\node_modules\\babel-loader\\lib\\index.js","mtime":1654499747895},{"path":"C:\\ex11\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1654499746565},{"path":"C:\\ex11\\node_modules\\vue-loader\\lib\\index.js","mtime":1654499750089}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8g7YyM7J207Ja067Kg7J207Iqk7JeQ7IScIERC7JmAIOyKpO2GoOumrOyngCDqsJ3ssrQg6rCA7KC47Ji0CmltcG9ydCB7IG9TdG9yYWdlLCBvUGljdHVyZXNpbkRCIH0gZnJvbSAnQC9kYXRhc291cmNlcy9maXJlYmFzZSc7CmV4cG9ydCBkZWZhdWx0IHsKICAvLyDtjIzsnbTslrTrsqDsnbTsiqTsmYAg7Jew6rKw65CcIOu3sO2MjOydtOyWtCBvUGljdHVyZXMg6rCd7LK0IOykgOu5hAogIGZpcmViYXNlOiB7CiAgICBvUGljdHVyZXM6IG9QaWN0dXJlc2luREIKICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBvUGljdHVyZXM6IFtdLAogICAgICAvLyDsgqzsp4Qg642w7J207YSwIOyggOyepSDrs4DsiJgKICAgICAgb1ZpZGVvU3RyZWFtOiBudWxsLAogICAgICAvLyDsubTrqZTrnbwg7JiB7IOBIOyKpO2KuOumvOydhCDsoIDsnqXtlaAg6rCd7LK067OA7IiYCiAgICAgIGJJc1dhaXQ6IGZhbHNlCiAgICB9OwogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgLy8gV2ViIEFQSeulvCDthrXtlbTshJwg7IKs7Jqp7J6QIOy5tOuplOudvOydmCDsoJHqt7wo7JiB7IOBIG9ubHkp7J2EIOyalOyyre2VqAogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoewogICAgICB2aWRlbzogdHJ1ZQogICAgfSkudGhlbihmdW5jdGlvbiAocFZpZGVvU3RyZWFtKSB7CiAgICAgIC8vIOy5tOuplOudvCDsmIHsg4Eg7Iqk7Yq466a8IOygleuztOulvCBvVmlkZW9TdHJlYW3sl5Ag7KCA7J6l7ZWoCiAgICAgIF90aGlzLm9WaWRlb1N0cmVhbSA9IHBWaWRlb1N0cmVhbTsgLy8g7Lm066mU6528IOyYgeyDgSDsiqTtirjrprwg7KCV67O066W8IHZpZGVvIOyXmOumrOuovO2KuOyXkCDtkZzsi5ztlagKCiAgICAgIF90aGlzLiRyZWZzLnJWaWRlby5zcmNPYmplY3QgPSBwVmlkZW9TdHJlYW07CgogICAgICBfdGhpcy4kcmVmcy5yVmlkZW8ucGxheSgpOwogICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgICBjb25zb2xlLmxvZyhlcnIpOwogICAgfSk7CiAgfSwKICBkZXN0cm95ZWQ6IGZ1bmN0aW9uIGRlc3Ryb3llZCgpIHsKICAgIC8vIO2YhOyerCDtmZTrqbTsnYQg7KKF66OM7ZWgIOqyveyasCDtmITsnqwg7J6s7IOd65CY64qUIOyYgeyDgSDtirjrnpnsnYQg7LC+7JWEIOyiheujjOyLnO2CtAogICAgdmFyIG9UcmFjayA9IHRoaXMub1ZpZGVvU3RyZWFtLmdldFRyYWNrcygpOwogICAgb1RyYWNrLm1hcChmdW5jdGlvbiAocFRyYWNrKSB7CiAgICAgIHJldHVybiBwVHJhY2suc3RvcCgpOwogICAgfSk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBmbkNhbWVyYUNhcHR1cmU6IGZ1bmN0aW9uIGZuQ2FtZXJhQ2FwdHVyZSgpIHsKICAgICAgdGhpcy5iSXNXYWl0ID0gdHJ1ZTsgLy8g7ZiE7J6sIOyerOyDneuQmOuKlCDtirjrnpnsnYQg7LC+7JWEIOyKpO2LuOydtOuvuOyngOuhnCDsuqHsspjtlagKCiAgICAgIHZhciBvVmlkZW9UcmFjayA9IHRoaXMub1ZpZGVvU3RyZWFtLmdldFZpZGVvVHJhY2tzKClbMF07CiAgICAgIHZhciBvQ2FwdHVyZWRJbWFnZSA9IG5ldyB3aW5kb3cuSW1hZ2VDYXB0dXJlKG9WaWRlb1RyYWNrKTsKICAgICAgdmFyIG9wdGlvbnMgPSB7CiAgICAgICAgaW1hZ2VIZWlnaHQ6IDM1OSwKICAgICAgICBpbWFnZVdpZHRoOiA2NDAsCiAgICAgICAgZmlsbExpZ2h0TW9kZTogJ29mZicKICAgICAgfTsKICAgICAgdmFyIHNlbGYgPSB0aGlzOyAvLyDsuqHsspjrkJwg7J2066+47KeA66W8IO2MjOydtOyWtOuyoOydtOyKpCBEQuyZgCDsiqTthqDrpqzsp4Dsl5Ag7KCA7J6l7ZWoCgogICAgICByZXR1cm4gb0NhcHR1cmVkSW1hZ2UudGFrZVBob3RvKG9wdGlvbnMpLnRoZW4oZnVuY3Rpb24gKHBJbWFnZURhdGEpIHsKICAgICAgICAvLyDsmIHsg4Eg7KCV7KeACiAgICAgICAgdmFyIG9UcmFjayA9IHNlbGYub1ZpZGVvU3RyZWFtLmdldFRyYWNrcygpOwogICAgICAgIG9UcmFjay5tYXAoZnVuY3Rpb24gKHBUcmFjaykgewogICAgICAgICAgcmV0dXJuIHBUcmFjay5zdG9wKCk7CiAgICAgICAgfSk7CiAgICAgICAgY29uc29sZS5sb2coJ+y6oeyymDogJyArIHBJbWFnZURhdGEudHlwZSArICcsICcgKyBwSW1hZ2VEYXRhLnNpemUgKyAn67CU7J207Yq4Jyk7IC8vIOyggOyepe2VoCDsnbTrr7jsp4Ag7YyM7J287J2066aE7Jy866GcIOyCrOyaqe2VoCBJRCDspIDruYQKCiAgICAgICAgdmFyIG5JRCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTsgLy8g7YyM7J207Ja067Kg7J207IqkIOyKpO2GoOumrOyngOyXkCDsnbTrr7jsp4Ag7YyM7J28IOyggOyepQoKICAgICAgICB2YXIgdXBsb2FkVGFzayA9IG9TdG9yYWdlLnJlZignaW1hZ2VzJykuY2hpbGQoJ3BpYycgKyBuSUQpLnB1dChwSW1hZ2VEYXRhKTsKICAgICAgICB1cGxvYWRUYXNrLm9uKCdzdGF0ZV9jaGFuZ2VkJywgZnVuY3Rpb24gKHNuYXBzaG90KSB7CiAgICAgICAgICAvLyBzdGF0ZV9jaGFuZ2VkIOydtOuypO2KuOulvCDthrXtlbTshJwg7Ja866eM7YG87J2YIOuwlOydtO2KuOqwgCDsl4XroZzrk5wg7KSR7J247KeAIOy9mOyGlOyXkCDtkZzsi5wKICAgICAgICAgIHZhciBwcm9ncmVzcyA9IHNuYXBzaG90LmJ5dGVzVHJhbnNmZXJyZWQgLyBzbmFwc2hvdC50b3RhbEJ5dGVzICogMTAwOwogICAgICAgICAgY29uc29sZS5sb2coJ+yXheuhnOuTnDogJyArIHByb2dyZXNzICsgJyUg7JmE66OMJywgc25hcHNob3Quc3RhdGUpOwogICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOyAvLyDsmKTrpZgg67Cc7IOdIOyLnCDsvZjshpTsl5Ag7ZGc7IucCiAgICAgICAgfSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8g7ISx6rO17KCB7Jy866GcIOyXheuhnOuTnCDsmYTro4wg7ZuEIO2MjOydtOyWtOuyoOydtOyKpCBEQuyXkCDsoJXrs7Qg7KCA7J6lCiAgICAgICAgICB1cGxvYWRUYXNrLnNuYXBzaG90LnJlZi5nZXREb3dubG9hZFVSTCgpLnRoZW4oZnVuY3Rpb24gKGRvd25sb2FkVVJMKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfsl4XroZzrk5xVUkw6JywgZG93bmxvYWRVUkwpOwogICAgICAgICAgICBvUGljdHVyZXNpbkRCLnB1c2goewogICAgICAgICAgICAgICd1cmwnOiBkb3dubG9hZFVSTCwKICAgICAgICAgICAgICAndGl0bGUnOiAnJywKICAgICAgICAgICAgICAnaW5mbyc6ICcnLAogICAgICAgICAgICAgICdmaWxlbmFtZSc6ICdwaWMnICsgbklECiAgICAgICAgICAgIH0pLnRoZW4oc2VsZi4kcm91dGVyLnB1c2goJy8nKSk7IC8vIOyggOyepSDtm4Qg7ZmIIO2ZlOuptOycvOuhnCDsnbTrj5kKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["camera_page.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <v-container>\r\n    <v-row>\r\n      <v-col cols=\"12\" class=\"text-center\">\r\n        <!-- 카메라 영상 부분을 표시 -->\r\n        <video ref=\"rVideo\" class=\"style_video\"></video>\r\n      </v-col>\r\n      <v-col cols=\"12\" class=\"mt-5 text-center\">\r\n        <!-- 만약에 업로드된 이미지가 없으면 안내 문구 표시-->\r\n        <p>현재 iOS는 지원하지 않습니다.</p>\r\n      </v-col>\r\n    </v-row>\r\n    <div class=\"text-center my-3\">\r\n      <!-- 카메라 캡처 버튼을 영상 하단 중앙에 위치 -->\r\n      <v-btn v-if=\"!this.bIsWait\" color=\"red\" fab dark bottom @click=\"fnCameraCapture( )\">\r\n        <v-icon>camera</v-icon>\r\n      </v-btn>\r\n      <v-progress-circular v-if=\"this.bIsWait\" :size=\"50\" indeterminate color=\"grey\"></v-progress-circular>\r\n    </div>\r\n  </v-container>\r\n</template>\r\n\r\n<script>\r\n  // 파이어베이스에서 DB와 스토리지 객체 가져옴\r\n  import {\r\n    oStorage,\r\n    oPicturesinDB\r\n  } from '@/datasources/firebase'\r\n  export default {\r\n    // 파이어베이스와 연결된 뷰파이어 oPictures 객체 준비\r\n    firebase: {\r\n      oPictures: oPicturesinDB\r\n    },\r\n    data() {\r\n      return {\r\n        oPictures: [], // 사진 데이터 저장 변수\r\n        oVideoStream: null, // 카메라 영상 스트림을 저장할 객체변수\r\n        bIsWait: false\r\n      }\r\n    },\r\n    mounted() {\r\n      // Web API를 통해서 사용자 카메라의 접근(영상 only)을 요청함\r\n      navigator.mediaDevices.getUserMedia({\r\n        video: true\r\n      }).then(pVideoStream => {\r\n        // 카메라 영상 스트림 정보를 oVideoStream에 저장함\r\n        this.oVideoStream = pVideoStream\r\n        // 카메라 영상 스트림 정보를 video 엘리먼트에 표시함\r\n        this.$refs.rVideo.srcObject = pVideoStream\r\n        this.$refs.rVideo.play()\r\n      }).catch(function (err) {\r\n        console.log(err)\r\n      })\r\n    },\r\n    destroyed() {\r\n      // 현재 화면을 종료할 경우 현재 재생되는 영상 트랙을 찾아 종료시킴\r\n      const oTrack = this.oVideoStream.getTracks()\r\n      oTrack.map(pTrack => pTrack.stop())\r\n    },\r\n    methods: {\r\n      fnCameraCapture() {\r\n        this.bIsWait = true\r\n        // 현재 재생되는 트랙을 찾아 스틸이미지로 캡처함\r\n        const oVideoTrack = this.oVideoStream.getVideoTracks()[0]\r\n        let oCapturedImage = new window.ImageCapture(oVideoTrack)\r\n        const options = {\r\n          imageHeight: 359,\r\n          imageWidth: 640,\r\n          fillLightMode: 'off'\r\n        };\r\n        const self = this\r\n        // 캡처된 이미지를 파이어베이스 DB와 스토리지에 저장함\r\n        return oCapturedImage.takePhoto(options).then(pImageData => {\r\n          // 영상 정지\r\n          const oTrack = self.oVideoStream.getTracks()\r\n          oTrack.map(pTrack => pTrack.stop())\r\n          console.log('캡처: ' + pImageData.type + ', ' + pImageData.size + '바이트');\r\n          // 저장할 이미지 파일이름으로 사용할 ID 준비\r\n          const nID = new Date().toISOString()\r\n          // 파이어베이스 스토리지에 이미지 파일 저장\r\n          let uploadTask = oStorage.ref('images').child('pic' + nID).put(pImageData)\r\n          uploadTask.on('state_changed', function (snapshot) {\r\n            // state_changed 이벤트를 통해서 얼만큼의 바이트가 업로드 중인지 콘솔에 표시\r\n            let progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\r\n            console.log('업로드: ' + progress + '% 완료', snapshot.state);\r\n          }, function (error) {\r\n            console.log(error)\r\n            // 오류 발생 시 콘솔에 표시\r\n          }, function () {\r\n            // 성공적으로 업로드 완료 후 파이어베이스 DB에 정보 저장\r\n            uploadTask.snapshot.ref.getDownloadURL().then(function (downloadURL) {\r\n              console.log('업로드URL:', downloadURL);\r\n              oPicturesinDB.push({\r\n                  'url': downloadURL,\r\n                  'title': '',\r\n                  'info': '',\r\n                  'filename': 'pic' + nID\r\n                })\r\n                .then(self.$router.push('/')) // 저장 후 홈 화면으로 이동\r\n            });\r\n          });\r\n        })\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style>\r\n  /* 카메라 영상의 너비값을 브라우저 너비에 맞춤 */\r\n  .style_video {\r\n    width: 100%\r\n  }\r\n</style>"],"sourceRoot":"src/components"}]}